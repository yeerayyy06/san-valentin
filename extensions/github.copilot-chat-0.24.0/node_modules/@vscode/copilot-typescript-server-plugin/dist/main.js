"use strict";var st=Object.create;var et=Object.defineProperty;var at=Object.getOwnPropertyDescriptor;var lt=Object.getOwnPropertyNames;var dt=Object.getPrototypeOf,ct=Object.prototype.hasOwnProperty;var ut=(u,e)=>()=>(e||u((e={exports:{}}).exports,e),e.exports);var pt=(u,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of lt(e))!ct.call(u,r)&&r!==n&&et(u,r,{get:()=>e[r],enumerable:!(i=at(e,r))||i.enumerable});return u};var D=(u,e,n)=>(n=u!=null?st(dt(u)):{},pt(e||!u||!u.__esModule?et(n,"default",{value:u,enumerable:!0}):n,u));var G=ut((Ct,nt)=>{"use strict";var t=D(require("typescript")),tt;(B=>{let u=t.default;B.getTokenAtPosition=u.getTokenAtPosition,B.getNameTable=u.getNameTable,B.findReferencedSymbols=u.findReferencedSymbols,B.getSymbolId=u.getSymbolId;class o{cancellationToken;end;constructor(s,c,m=!1){this.cancellationToken=s,this.end=m?Number.MAX_VALUE:Date.now()+c}isCancellationRequested(){return this.cancellationToken&&this.cancellationToken.isCancellationRequested()?!0:Date.now()>this.end}isTimedOut(){return Date.now()>this.end}throwIfCancellationRequested(){if(this.isCancellationRequested())throw new t.default.OperationCanceledException}}B.CancellationTokenWithTimer=o;class a{isCancellationRequested(){return!1}throwIfCancellationRequested(){}}B.NullCancellationToken=a;let l;(c=>{function L(m){return m.symbol}c.getSymbol=L;function s(m){if((0,t.isTypeReferenceNode)(m))return m.typeName.getText()}c.getTypeName=s})(l=B.Node||={});let p;(s=>{function L(c){return(t.default.getCombinedModifierFlags(c)&t.default.ModifierFlags.Private)!==0}s.isPrivate=L})(p=B.Declarations||={});let d;(m=>{function L(h){let b=h.heritageClauses;if(b!==void 0)return b.find(y=>y.token===t.default.SyntaxKind.ExtendsKeyword)}m.getExtendsClause=L;function s(h){return c(h.statements)}m.entries=s;function*c(h){for(let b of h)t.default.isClassDeclaration(b)?yield b:t.default.isModuleDeclaration(b)&&b.body!==void 0&&t.default.isModuleBlock(b.body)&&(yield*c(b.body.statements))}})(d=B.ClassDeclarations||={});let g;(c=>{function L(m){return m.getBaseTypes()}c.getBaseTypes=L;function s(m,h){let b=h.getSymbol();if(b===void 0)return;let y=b.getDeclarations();if(y===void 0)return;let f=[];for(let S of y)if(t.default.isClassDeclaration(S)){let T=S.heritageClauses;if(T!==void 0)for(let R of T)for(let _ of R.types)f.push(m.getTypeAtLocation(_.expression))}return f}c.getExtendsTypes=s})(g=B.Types||={});let C;(c=>(c.depthFirst="depthFirst",c.breadthFirst="breadthFirst"))(C=B.Traversal||={});let w;(s=>s.breadthFirstOnly="breadthFirstOnly")(w||={});class x{program;typeChecker;constructor(s){this.program=s,this.typeChecker=s.getTypeChecker()}static Unknown="unknown";static Undefined="undefined";static None="none";static getParent(s){return s.parent}static isConstructor(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.Constructor)!==0}static isGetAccessor(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.GetAccessor)!==0}static isSetAccessor(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.SetAccessor)!==0}static isMethod(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.Method)!==0}static isProperty(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.Property)!==0}static isClass(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.Class)!==0}static isInterface(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.Interface)!==0}static isTypeAlias(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.TypeAlias)!==0}static isTypeLiteral(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.TypeLiteral)!==0}static isAlias(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.Alias)!==0}static isFunction(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.Function)!==0}static isValueModule(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.ValueModule)!==0}static isEnum(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.Enum)!==0}static isRegularEnum(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.RegularEnum)!==0}static isConstEnum(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.ConstEnum)!==0}static isBase(s){return s!==void 0&&(s.getFlags()&t.default.SymbolFlags.Class)!==0}static isPrivate(s){let c=s.declarations;if(c!==void 0){for(let m of c)if(!(t.default.getCombinedModifierFlags(m)&t.default.ModifierFlags.Private))return!1}return!0}static isAbstract(s){let c=s.declarations;if(c!==void 0){for(let m of c)if(!(t.default.getCombinedModifierFlags(m)&t.default.ModifierFlags.Abstract))return!1}return!0}static isStatic(s){let c=s.declarations;if(c!==void 0){for(let m of c)if(!(t.default.getCombinedModifierFlags(m)&t.default.ModifierFlags.Static))return!1}return!0}static fillSources(s,c){if(c.declarations!==void 0)for(let m of c.declarations){let h=m.getSourceFile();h!==void 0&&s.add(h.fileName)}}static getPrimarySource(s){let c=s.declarations;if(!(c===void 0||c.length===0))return c[0].getSourceFile()}static createKey(s,c){let m=s.getDeclarations();if(m===void 0)return;let h=[];for(let y of m){let f=y.getSourceFile();h.push({f:f.fileName,s:y.getStart(),e:y.getEnd(),k:y.kind})}h.length>1&&h.sort((y,f)=>{let S=y.f<f.f?-1:y.f>f.f?1:0;return S!==0||(S=y.s-f.s,S!==0)||(S=y.e-f.e,S!==0)?S:y.k-f.k});let b=c.createHash("md5");return s.flags&t.default.SymbolFlags.Transient&&b.update(JSON.stringify({trans:!0},void 0,0)),b.update(JSON.stringify(h,void 0,0)),b.digest("base64")}static createVersionedKey(s,c,m){let h=s.getDeclarations();if(h===void 0)return;let b=[];for(let f of h){let S=f.getSourceFile(),T=c.getScriptVersion(S);if(T===void 0)return;b.push({f:S.fileName,v:T,s:f.getStart(),e:f.getEnd(),k:f.kind})}b.length>1&&b.sort((f,S)=>{let T=f.f<S.f?-1:f.f>S.f?1:0;return T!==0||(T=f.v<S.v?-1:f.v>S.v?1:0,T!==0)||(T=f.s-S.s,T!==0)||(T=f.e-S.e,T!==0)?T:f.k-S.k});let y=m.createHash("md5");return s.flags&t.default.SymbolFlags.Transient&&y.update(JSON.stringify({trans:!0},void 0,0)),y.update(JSON.stringify(b,void 0,0)),y.digest("base64")}getProgram(){return this.program}getTypeChecker(){return this.typeChecker}getSymbolAtLocation(s){let c=this.typeChecker.getSymbolAtLocation(s);return c===void 0&&(c=l.getSymbol(s)),c}getExtendsSymbol(s){let c=s.declarations;if(c===void 0)return[void 0,void 0];for(let m of c)if(t.default.isClassDeclaration(m)){let h=m.heritageClauses;if(h!==void 0){for(let b of h)if(b.token===t.default.SyntaxKind.ExtendsKeyword){let y=b.types[0]?.expression,f=this.typeChecker.getSymbolAtLocation(y);if(x.isAlias(f)&&(f=this.typeChecker.getAliasedSymbol(f)),x.isClass(f))return[f,y.getText()]}}}return[void 0,void 0]}getLeafSymbolAtLocation(s){let c=this.getSymbolAtLocation(s);if(c!==void 0)return x.isAlias(c)?this.typeChecker.getAliasedSymbol(c):c}getSymbolAtTypeNodeLocation(s){return t.default.isTypeReferenceNode(s)?this.getLeafSymbolAtLocation(s.typeName):t.default.isTypeLiteralNode(s)?this.getLeafSymbolAtLocation(s):this.getLeafSymbolAtLocation(s)}getAliasedSymbol(s){return this.typeChecker.getAliasedSymbol(s)}getAllSuperTypes(s){return this._getAllSuperTypes(s,new Set,!1)}getAllSuperTypesWithPath(s){return this._getAllSuperTypes(s,new Set,!0)}*_getAllSuperTypes(s,c,m){if(x.isAlias(s)&&(c.add(s),s=this.typeChecker.getAliasedSymbol(s)),x.isClass(s)||x.isInterface(s)){let h=s.declarations;if(h===void 0)return;for(let b of h){let y;if((t.default.isClassDeclaration(b)||t.default.isInterfaceDeclaration(b))&&(y=b.heritageClauses),y!==void 0)for(let f of y)for(let S of f.types){let T=this.getLeafSymbolAtLocation(S.expression);T!==void 0&&!c.has(T)&&(yield m?[s,T]:T,c.add(T),yield*this._getAllSuperTypes(T,c,m))}}}else if(x.isTypeAlias(s)){let h=s.declarations;if(h===void 0)return;for(let b of h)if(t.default.isTypeAliasDeclaration(b)){let y=b.type;if(t.default.isTypeLiteralNode(y)){let f=this.getSymbolAtLocation(y);f!==void 0&&!c.has(f)&&(yield m?[s,f]:f,c.add(f))}else if(t.default.isTypeReferenceNode(y)){let f=this.getLeafSymbolAtLocation(y.typeName);f!==void 0&&!c.has(f)&&(yield m?[s,f]:f,c.add(f),yield*this._getAllSuperTypes(f,c,m))}else if(t.default.isIntersectionTypeNode(y))for(let f of y.types){let S=this.getSymbolAtTypeNodeLocation(f);S!==void 0&&!c.has(S)&&(x.isTypeLiteral(S)?(yield m?[s,S]:S,c.add(S)):x.isTypeAlias(S)?(c.add(S),yield*this._getAllSuperTypes(S,c,m)):(yield m?[s,S]:S,c.add(S),yield*this._getAllSuperTypes(S,c,m)))}}}}getAllSuperClasses(s){return this._getAllSuperClasses(s,new Set)}*_getAllSuperClasses(s,c){if(!x.isClass(s))return;let m=[s];for(;m.length>0;){let b=m.pop().declarations;if(b!==void 0)for(let y of b){if(!t.default.isClassDeclaration(y))continue;let f=y.heritageClauses;if(f!==void 0)for(let S of f){if(S.token!==t.default.SyntaxKind.ExtendsKeyword||S.types.length<1)continue;let T=S.types[0],R=this.getLeafSymbolAtLocation(T.expression);R!==void 0&&!c.has(R)&&(yield R,c.add(R),m.push(R))}}}}getDirectSubTypes(s,c,m=new M){return this._getAllSubTypes(s,"breadthFirstOnly",c,m,new Set)}getAllSubTypes(s,c="depthFirst",m,h=new M){return this._getAllSubTypes(s,c,m,h,new Set)}*_getAllSubTypes(s,c,m,h=new M,b){if(!x.isClass(s))return;let y=[s];for(;y.length>0;){let f=y.pop(),S=f.declarations;if(S===void 0||S.length===0)return;for(let T of S){if(!t.default.isClassDeclaration(T))continue;let R=new H(this.program,T.getSourceFile(),m,h);for(let _ of R)for(let N of d.entries(_)){let $=d.getExtendsClause(N);if($===void 0||$.types.length===0)continue;if(this.getLeafSymbolAtLocation($.types[0].expression)===f){let Y=this.getSymbolAtLocation(N.name?N.name:N);Y!==void 0&&!b.has(Y)&&x.isClass(Y)&&(yield Y,b.add(Y),c==="depthFirst"?yield*this._getAllSubTypes(Y,c,m,h,b):c==="breadthFirst"&&y.push(Y))}}}}}getMemberStatistic(s){let c=new Set,m=new Set;x._getMemberStatistic(c,m,s);for(let h of this.getAllSuperTypes(s))x._getMemberStatistic(c,m,h);return{abstract:c,concrete:m}}static _getMemberStatistic(s,c,m){if(x.isClass(m)){let h=m.declarations;if(h===void 0)return;for(let b of h)if(t.default.isClassDeclaration(b))for(let y of b.members)if(t.default.isMethodDeclaration(y)||t.default.isGetAccessorDeclaration(y)||t.default.isSetAccessorDeclaration(y)||t.default.isPropertyDeclaration(y)){let f=y.name.getText();x.includesAbstract(y.modifiers)&&!c.has(f)?s.add(f):c.add(f)}else t.default.isIndexSignatureDeclaration(y)&&(x.includesAbstract(y.modifiers)&&!c.has("[]")?s.add("[]"):c.add("[]"))}else if((x.isInterface(m)||x.isTypeLiteral(m))&&m.members!==void 0)for(let h of m.members.values())c.has(h.name)||s.add(h.name)}static includesAbstract(s){return s===void 0?!1:s.some(c=>c.kind===t.default.SyntaxKind.AbstractKeyword)}}B.Symbols=x;let P;(m=>{function L(h){return h.projectService}m.getProjectService=L;function s(h,b){let y=h;if(typeof y.getFileAndProject=="function")return y.getFileAndProject(b)}m.getFileAndProject=s;function c(h,b,y){let f=h;if(typeof f.getPositionInFile=="function")return f.getPositionInFile(b,y)}m.getPositionInFile=c})(P=B.Sessions||={});function J(L){return L.moduleReference.kind===t.SyntaxKind.ExternalModuleReference&&L.moduleReference.expression.kind===t.SyntaxKind.StringLiteral}class M{visited;_cache;constructor(s=!1){this.visited=new Map,s&&(this._cache=new Map)}get cache(){return this._cache}ensureCache(){this._cache===void 0&&(this._cache=new Map)}}B.ReferencedByContext=M;class H{program;sourceFile;preferredSourceFiles;context;visited;constructor(s,c,m,h){this.program=s,this.sourceFile=c,this.preferredSourceFiles=m,this.context=h,this.visited=H.getVisited(h.visited,c)}static getVisited(s,c){let m=s.get(c.fileName);return m===void 0&&(m=new Set,s.set(c.fileName,m)),m}getSourceFile(s){return this.program.getSourceFile(s)}[Symbol.iterator](){return this.entries()}*entries(){if(this.context.cache!==void 0&&this.context.cache.has(this.sourceFile.fileName)){for(let f of this.context.cache.get(this.sourceFile.fileName)){let S=this.program.getSourceFile(f);S!==void 0&&(yield S)}return}function s(f){return f.kind===t.SyntaxKind.ModuleDeclaration&&f.name.kind===t.SyntaxKind.StringLiteral}let c=this.context.cache?.get(this.sourceFile.fileName),m=this.program,h=m.getTypeChecker(),b=h.getSymbolAtLocation(this.sourceFile),y=this.visited;for(let f of this.allSourceFiles()){if(this.sourceFile===f){yield f,y.add(f.fileName);continue}if(!(y.has(f.fileName)||this.skipSourceFile(m,f)))if(f.externalModuleIndicator&&f.imports!==void 0){for(let S of f.imports)if(h.getSymbolAtLocation(S)===b){yield f,y.add(f.fileName),c&&c.add(f.fileName);break}}else{let S=f,T=S.kind===t.SyntaxKind.SourceFile?S.statements:S.body.statements,R=_=>{switch(_.kind){case t.SyntaxKind.ExportDeclaration:case t.SyntaxKind.ImportDeclaration:{let N=_;if(N.moduleSpecifier&&t.default.isStringLiteral(N.moduleSpecifier)&&h.getSymbolAtLocation(N.moduleSpecifier)===b)return!0;break}case t.SyntaxKind.ImportEqualsDeclaration:{let N=_;if(J(N)&&h.getSymbolAtLocation(N.moduleReference.expression)===b)return!0;break}}return!1};e:for(let _ of T)if(!y.has(f.fileName)&&R(_)){yield f,y.add(f.fileName),c&&c.add(f.fileName);break e}else if(s(_)){let N=_.body&&_.body.statements;if(N!==void 0){for(let $ of N)if(!y.has(f.fileName)&&R($)){yield f,y.add(f.fileName),c&&c.add(f.fileName);break e}}}}}}skipSourceFile(s,c){return s.isSourceFileDefaultLibrary(c)||s.isSourceFileFromExternalLibrary(c)||c.isDeclarationFile}*allSourceFiles(){this.preferredSourceFiles!==void 0&&(yield*this.preferredSourceFiles),yield*this.program.getSourceFiles()}}B.ReferencedByVisitor=H;let j;(m=>{let L=new Map([[t.SyntaxKind.Unknown,0],[t.SyntaxKind.EndOfFileToken,1],[t.SyntaxKind.SingleLineCommentTrivia,2],[t.SyntaxKind.MultiLineCommentTrivia,3],[t.SyntaxKind.NewLineTrivia,4],[t.SyntaxKind.WhitespaceTrivia,5],[t.SyntaxKind.ShebangTrivia,6],[t.SyntaxKind.ConflictMarkerTrivia,7],[t.SyntaxKind.NonTextFileMarkerTrivia,8],[t.SyntaxKind.NumericLiteral,9],[t.SyntaxKind.BigIntLiteral,10],[t.SyntaxKind.StringLiteral,11],[t.SyntaxKind.JsxText,12],[t.SyntaxKind.JsxTextAllWhiteSpaces,13],[t.SyntaxKind.RegularExpressionLiteral,14],[t.SyntaxKind.NoSubstitutionTemplateLiteral,15],[t.SyntaxKind.TemplateHead,16],[t.SyntaxKind.TemplateMiddle,17],[t.SyntaxKind.TemplateTail,18],[t.SyntaxKind.OpenBraceToken,19],[t.SyntaxKind.CloseBraceToken,20],[t.SyntaxKind.OpenParenToken,21],[t.SyntaxKind.CloseParenToken,22],[t.SyntaxKind.OpenBracketToken,23],[t.SyntaxKind.CloseBracketToken,24],[t.SyntaxKind.DotToken,25],[t.SyntaxKind.DotDotDotToken,26],[t.SyntaxKind.SemicolonToken,27],[t.SyntaxKind.CommaToken,28],[t.SyntaxKind.QuestionDotToken,29],[t.SyntaxKind.LessThanToken,30],[t.SyntaxKind.LessThanSlashToken,31],[t.SyntaxKind.GreaterThanToken,32],[t.SyntaxKind.LessThanEqualsToken,33],[t.SyntaxKind.GreaterThanEqualsToken,34],[t.SyntaxKind.EqualsEqualsToken,35],[t.SyntaxKind.ExclamationEqualsToken,36],[t.SyntaxKind.EqualsEqualsEqualsToken,37],[t.SyntaxKind.ExclamationEqualsEqualsToken,38],[t.SyntaxKind.EqualsGreaterThanToken,39],[t.SyntaxKind.PlusToken,40],[t.SyntaxKind.MinusToken,41],[t.SyntaxKind.AsteriskToken,42],[t.SyntaxKind.AsteriskAsteriskToken,43],[t.SyntaxKind.SlashToken,44],[t.SyntaxKind.PercentToken,45],[t.SyntaxKind.PlusPlusToken,46],[t.SyntaxKind.MinusMinusToken,47],[t.SyntaxKind.LessThanLessThanToken,48],[t.SyntaxKind.GreaterThanGreaterThanToken,49],[t.SyntaxKind.GreaterThanGreaterThanGreaterThanToken,50],[t.SyntaxKind.AmpersandToken,51],[t.SyntaxKind.BarToken,52],[t.SyntaxKind.CaretToken,53],[t.SyntaxKind.ExclamationToken,54],[t.SyntaxKind.TildeToken,55],[t.SyntaxKind.AmpersandAmpersandToken,56],[t.SyntaxKind.BarBarToken,57],[t.SyntaxKind.QuestionToken,58],[t.SyntaxKind.ColonToken,59],[t.SyntaxKind.AtToken,60],[t.SyntaxKind.QuestionQuestionToken,61],[t.SyntaxKind.BacktickToken,62],[t.SyntaxKind.HashToken,63],[t.SyntaxKind.EqualsToken,64],[t.SyntaxKind.PlusEqualsToken,65],[t.SyntaxKind.MinusEqualsToken,66],[t.SyntaxKind.AsteriskEqualsToken,67],[t.SyntaxKind.AsteriskAsteriskEqualsToken,68],[t.SyntaxKind.SlashEqualsToken,69],[t.SyntaxKind.PercentEqualsToken,70],[t.SyntaxKind.LessThanLessThanEqualsToken,71],[t.SyntaxKind.GreaterThanGreaterThanEqualsToken,72],[t.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken,73],[t.SyntaxKind.AmpersandEqualsToken,74],[t.SyntaxKind.BarEqualsToken,75],[t.SyntaxKind.BarBarEqualsToken,76],[t.SyntaxKind.AmpersandAmpersandEqualsToken,77],[t.SyntaxKind.QuestionQuestionEqualsToken,78],[t.SyntaxKind.CaretEqualsToken,79],[t.SyntaxKind.Identifier,80],[t.SyntaxKind.PrivateIdentifier,81],[t.SyntaxKind.BreakKeyword,83],[t.SyntaxKind.CaseKeyword,84],[t.SyntaxKind.CatchKeyword,85],[t.SyntaxKind.ClassKeyword,86],[t.SyntaxKind.ConstKeyword,87],[t.SyntaxKind.ContinueKeyword,88],[t.SyntaxKind.DebuggerKeyword,89],[t.SyntaxKind.DefaultKeyword,90],[t.SyntaxKind.DeleteKeyword,91],[t.SyntaxKind.DoKeyword,92],[t.SyntaxKind.ElseKeyword,93],[t.SyntaxKind.EnumKeyword,94],[t.SyntaxKind.ExportKeyword,95],[t.SyntaxKind.ExtendsKeyword,96],[t.SyntaxKind.FalseKeyword,97],[t.SyntaxKind.FinallyKeyword,98],[t.SyntaxKind.ForKeyword,99],[t.SyntaxKind.FunctionKeyword,100],[t.SyntaxKind.IfKeyword,101],[t.SyntaxKind.ImportKeyword,102],[t.SyntaxKind.InKeyword,103],[t.SyntaxKind.InstanceOfKeyword,104],[t.SyntaxKind.NewKeyword,105],[t.SyntaxKind.NullKeyword,106],[t.SyntaxKind.ReturnKeyword,107],[t.SyntaxKind.SuperKeyword,108],[t.SyntaxKind.SwitchKeyword,109],[t.SyntaxKind.ThisKeyword,110],[t.SyntaxKind.ThrowKeyword,111],[t.SyntaxKind.TrueKeyword,112],[t.SyntaxKind.TryKeyword,113],[t.SyntaxKind.TypeOfKeyword,114],[t.SyntaxKind.VarKeyword,115],[t.SyntaxKind.VoidKeyword,116],[t.SyntaxKind.WhileKeyword,117],[t.SyntaxKind.WithKeyword,118],[t.SyntaxKind.ImplementsKeyword,119],[t.SyntaxKind.InterfaceKeyword,120],[t.SyntaxKind.LetKeyword,121],[t.SyntaxKind.PackageKeyword,122],[t.SyntaxKind.PrivateKeyword,123],[t.SyntaxKind.ProtectedKeyword,124],[t.SyntaxKind.PublicKeyword,125],[t.SyntaxKind.StaticKeyword,126],[t.SyntaxKind.YieldKeyword,127],[t.SyntaxKind.AbstractKeyword,128],[t.SyntaxKind.AccessorKeyword,129],[t.SyntaxKind.AsKeyword,130],[t.SyntaxKind.AssertsKeyword,131],[t.SyntaxKind.AssertKeyword,132],[t.SyntaxKind.AnyKeyword,133],[t.SyntaxKind.AsyncKeyword,134],[t.SyntaxKind.AwaitKeyword,135],[t.SyntaxKind.BooleanKeyword,136],[t.SyntaxKind.ConstructorKeyword,137],[t.SyntaxKind.DeclareKeyword,138],[t.SyntaxKind.GetKeyword,139],[t.SyntaxKind.InferKeyword,140],[t.SyntaxKind.IntrinsicKeyword,141],[t.SyntaxKind.IsKeyword,142],[t.SyntaxKind.KeyOfKeyword,143],[t.SyntaxKind.ModuleKeyword,144],[t.SyntaxKind.NamespaceKeyword,145],[t.SyntaxKind.NeverKeyword,146],[t.SyntaxKind.OutKeyword,147],[t.SyntaxKind.ReadonlyKeyword,148],[t.SyntaxKind.RequireKeyword,149],[t.SyntaxKind.NumberKeyword,150],[t.SyntaxKind.ObjectKeyword,151],[t.SyntaxKind.SatisfiesKeyword,152],[t.SyntaxKind.SetKeyword,153],[t.SyntaxKind.StringKeyword,154],[t.SyntaxKind.SymbolKeyword,155],[t.SyntaxKind.TypeKeyword,156],[t.SyntaxKind.UndefinedKeyword,157],[t.SyntaxKind.UniqueKeyword,158],[t.SyntaxKind.UnknownKeyword,159],[t.SyntaxKind.UsingKeyword,160],[t.SyntaxKind.FromKeyword,161],[t.SyntaxKind.GlobalKeyword,162],[t.SyntaxKind.BigIntKeyword,163],[t.SyntaxKind.OverrideKeyword,164],[t.SyntaxKind.OfKeyword,165],[t.SyntaxKind.QualifiedName,166],[t.SyntaxKind.ComputedPropertyName,167],[t.SyntaxKind.TypeParameter,168],[t.SyntaxKind.Parameter,169],[t.SyntaxKind.Decorator,170],[t.SyntaxKind.PropertySignature,171],[t.SyntaxKind.PropertyDeclaration,172],[t.SyntaxKind.MethodSignature,173],[t.SyntaxKind.MethodDeclaration,174],[t.SyntaxKind.ClassStaticBlockDeclaration,175],[t.SyntaxKind.Constructor,176],[t.SyntaxKind.GetAccessor,177],[t.SyntaxKind.SetAccessor,178],[t.SyntaxKind.CallSignature,179],[t.SyntaxKind.ConstructSignature,180],[t.SyntaxKind.IndexSignature,181],[t.SyntaxKind.TypePredicate,182],[t.SyntaxKind.TypeReference,183],[t.SyntaxKind.FunctionType,184],[t.SyntaxKind.ConstructorType,185],[t.SyntaxKind.TypeQuery,186],[t.SyntaxKind.TypeLiteral,187],[t.SyntaxKind.ArrayType,188],[t.SyntaxKind.TupleType,189],[t.SyntaxKind.OptionalType,190],[t.SyntaxKind.RestType,191],[t.SyntaxKind.UnionType,192],[t.SyntaxKind.IntersectionType,193],[t.SyntaxKind.ConditionalType,194],[t.SyntaxKind.InferType,195],[t.SyntaxKind.ParenthesizedType,196],[t.SyntaxKind.ThisType,197],[t.SyntaxKind.TypeOperator,198],[t.SyntaxKind.IndexedAccessType,199],[t.SyntaxKind.MappedType,200],[t.SyntaxKind.LiteralType,201],[t.SyntaxKind.NamedTupleMember,202],[t.SyntaxKind.TemplateLiteralType,203],[t.SyntaxKind.TemplateLiteralTypeSpan,204],[t.SyntaxKind.ImportType,205],[t.SyntaxKind.ObjectBindingPattern,206],[t.SyntaxKind.ArrayBindingPattern,207],[t.SyntaxKind.BindingElement,208],[t.SyntaxKind.ArrayLiteralExpression,209],[t.SyntaxKind.ObjectLiteralExpression,210],[t.SyntaxKind.PropertyAccessExpression,211],[t.SyntaxKind.ElementAccessExpression,212],[t.SyntaxKind.CallExpression,213],[t.SyntaxKind.NewExpression,214],[t.SyntaxKind.TaggedTemplateExpression,215],[t.SyntaxKind.TypeAssertionExpression,216],[t.SyntaxKind.ParenthesizedExpression,217],[t.SyntaxKind.FunctionExpression,218],[t.SyntaxKind.ArrowFunction,219],[t.SyntaxKind.DeleteExpression,220],[t.SyntaxKind.TypeOfExpression,221],[t.SyntaxKind.VoidExpression,222],[t.SyntaxKind.AwaitExpression,223],[t.SyntaxKind.PrefixUnaryExpression,224],[t.SyntaxKind.PostfixUnaryExpression,225],[t.SyntaxKind.BinaryExpression,226],[t.SyntaxKind.ConditionalExpression,227],[t.SyntaxKind.TemplateExpression,228],[t.SyntaxKind.YieldExpression,229],[t.SyntaxKind.SpreadElement,230],[t.SyntaxKind.ClassExpression,231],[t.SyntaxKind.OmittedExpression,232],[t.SyntaxKind.ExpressionWithTypeArguments,233],[t.SyntaxKind.AsExpression,234],[t.SyntaxKind.NonNullExpression,235],[t.SyntaxKind.MetaProperty,236],[t.SyntaxKind.SyntheticExpression,237],[t.SyntaxKind.SatisfiesExpression,238],[t.SyntaxKind.TemplateSpan,239],[t.SyntaxKind.SemicolonClassElement,240],[t.SyntaxKind.Block,241],[t.SyntaxKind.EmptyStatement,242],[t.SyntaxKind.VariableStatement,243],[t.SyntaxKind.ExpressionStatement,244],[t.SyntaxKind.IfStatement,245],[t.SyntaxKind.DoStatement,246],[t.SyntaxKind.WhileStatement,247],[t.SyntaxKind.ForStatement,248],[t.SyntaxKind.ForInStatement,249],[t.SyntaxKind.ForOfStatement,250],[t.SyntaxKind.ContinueStatement,251],[t.SyntaxKind.BreakStatement,252],[t.SyntaxKind.ReturnStatement,253],[t.SyntaxKind.WithStatement,254],[t.SyntaxKind.SwitchStatement,255],[t.SyntaxKind.LabeledStatement,256],[t.SyntaxKind.ThrowStatement,257],[t.SyntaxKind.TryStatement,258],[t.SyntaxKind.DebuggerStatement,259],[t.SyntaxKind.VariableDeclaration,260],[t.SyntaxKind.VariableDeclarationList,261],[t.SyntaxKind.FunctionDeclaration,262],[t.SyntaxKind.ClassDeclaration,263],[t.SyntaxKind.InterfaceDeclaration,264],[t.SyntaxKind.TypeAliasDeclaration,265],[t.SyntaxKind.EnumDeclaration,266],[t.SyntaxKind.ModuleDeclaration,267],[t.SyntaxKind.ModuleBlock,268],[t.SyntaxKind.CaseBlock,269],[t.SyntaxKind.NamespaceExportDeclaration,270],[t.SyntaxKind.ImportEqualsDeclaration,271],[t.SyntaxKind.ImportDeclaration,272],[t.SyntaxKind.ImportClause,273],[t.SyntaxKind.NamespaceImport,274],[t.SyntaxKind.NamedImports,275],[t.SyntaxKind.ImportSpecifier,276],[t.SyntaxKind.ExportAssignment,277],[t.SyntaxKind.ExportDeclaration,278],[t.SyntaxKind.NamedExports,279],[t.SyntaxKind.NamespaceExport,280],[t.SyntaxKind.ExportSpecifier,281],[t.SyntaxKind.MissingDeclaration,282],[t.SyntaxKind.ExternalModuleReference,283],[t.SyntaxKind.JsxElement,284],[t.SyntaxKind.JsxSelfClosingElement,285],[t.SyntaxKind.JsxOpeningElement,286],[t.SyntaxKind.JsxClosingElement,287],[t.SyntaxKind.JsxFragment,288],[t.SyntaxKind.JsxOpeningFragment,289],[t.SyntaxKind.JsxClosingFragment,290],[t.SyntaxKind.JsxAttribute,291],[t.SyntaxKind.JsxAttributes,292],[t.SyntaxKind.JsxSpreadAttribute,293],[t.SyntaxKind.JsxExpression,294],[t.SyntaxKind.JsxNamespacedName,295],[t.SyntaxKind.CaseClause,296],[t.SyntaxKind.DefaultClause,297],[t.SyntaxKind.HeritageClause,298],[t.SyntaxKind.CatchClause,299],[t.SyntaxKind.ImportAttributes,300],[t.SyntaxKind.ImportAttribute,301],[t.SyntaxKind.PropertyAssignment,303],[t.SyntaxKind.ShorthandPropertyAssignment,304],[t.SyntaxKind.SpreadAssignment,305],[t.SyntaxKind.EnumMember,306],[t.SyntaxKind.SourceFile,307],[t.SyntaxKind.Bundle,308],[t.SyntaxKind.JSDocTypeExpression,309],[t.SyntaxKind.JSDocNameReference,310],[t.SyntaxKind.JSDocMemberName,311],[t.SyntaxKind.JSDocAllType,312],[t.SyntaxKind.JSDocUnknownType,313],[t.SyntaxKind.JSDocNullableType,314],[t.SyntaxKind.JSDocNonNullableType,315],[t.SyntaxKind.JSDocOptionalType,316],[t.SyntaxKind.JSDocFunctionType,317],[t.SyntaxKind.JSDocVariadicType,318],[t.SyntaxKind.JSDocNamepathType,319],[t.SyntaxKind.JSDoc,320],[t.SyntaxKind.JSDocText,321],[t.SyntaxKind.JSDocTypeLiteral,322],[t.SyntaxKind.JSDocSignature,323],[t.SyntaxKind.JSDocLink,324],[t.SyntaxKind.JSDocLinkCode,325],[t.SyntaxKind.JSDocLinkPlain,326],[t.SyntaxKind.JSDocTag,327],[t.SyntaxKind.JSDocAugmentsTag,328],[t.SyntaxKind.JSDocImplementsTag,329],[t.SyntaxKind.JSDocAuthorTag,330],[t.SyntaxKind.JSDocDeprecatedTag,331],[t.SyntaxKind.JSDocClassTag,332],[t.SyntaxKind.JSDocPublicTag,333],[t.SyntaxKind.JSDocPrivateTag,334],[t.SyntaxKind.JSDocProtectedTag,335],[t.SyntaxKind.JSDocReadonlyTag,336],[t.SyntaxKind.JSDocOverrideTag,337],[t.SyntaxKind.JSDocCallbackTag,338],[t.SyntaxKind.JSDocOverloadTag,339],[t.SyntaxKind.JSDocEnumTag,340],[t.SyntaxKind.JSDocParameterTag,341],[t.SyntaxKind.JSDocReturnTag,342],[t.SyntaxKind.JSDocThisTag,343],[t.SyntaxKind.JSDocTypeTag,344],[t.SyntaxKind.JSDocTemplateTag,345],[t.SyntaxKind.JSDocTypedefTag,346],[t.SyntaxKind.JSDocSeeTag,347],[t.SyntaxKind.JSDocPropertyTag,348],[t.SyntaxKind.JSDocThrowsTag,349],[t.SyntaxKind.JSDocSatisfiesTag,350],[t.SyntaxKind.JSDocImportTag,351],[t.SyntaxKind.SyntaxList,352],[t.SyntaxKind.NotEmittedStatement,353],[t.SyntaxKind.PartiallyEmittedExpression,354],[t.SyntaxKind.CommaListExpression,355],[t.SyntaxKind.SyntheticReferenceExpression,356]]),s=9999;function c(h){let b=[];for(;h!==void 0;)b.push(L.get(h.kind)??s),h=h.parent;return b}m.getPath=c})(j=B.StableSyntaxKinds||={})})(tt||={});nt.exports=tt});var de=D(require("typescript")),ot=D(G());var Q=D(require("typescript")),Ie=D(G());var ne=D(require("typescript"));var Ae;(e=>{function u(n,i){return{kind:"metaData",completionContext:n,path:i}}e.create=u})(Ae||={});var Ne;(e=>{function u(n,i){return{kind:"errorData",code:n,message:i}}e.create=u})(Ne||={});var Ee;(e=>{function u(n){return n.name.length+n.value.length}e.sizeInChars=u})(Ee||={});var te;(n=>{function u(i,r,o,a,l){return{kind:"snippet",snippetKind:a,uri:i,additionalUris:r,value:o,priority:l??0}}n.create=u;function e(i){let r=i.value.length;if(r+=i.uri.length+3,i.additionalUris!==void 0)for(let o of i.additionalUris)r+=o.length+3;return r}n.sizeInChars=e})(te||={});var ft;(i=>{function u(r){return r.type==="cancelled"}i.isCancelled=u;function e(r){return r.type==="response"&&r.body.items!==void 0}i.isOk=e;function n(r){return r.type==="response"&&r.body.error!==void 0}i.isError=n})(ft||={});var k=D(G());var Ke=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,n=0){let i=this._map.get(e);if(i)return n!==0&&this.touch(i,n),i.value}set(e,n,i=0){let r=this._map.get(e);if(r)r.value=n,i!==0&&this.touch(r,i);else{switch(r={key:e,value:n,next:void 0,previous:void 0},i){case 0:this.addItemLast(r);break;case 1:this.addItemFirst(r);break;case 2:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let n=this._map.get(e);if(n)return this._map.delete(e),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,n){let i=this._state,r=this._head;for(;r;){if(n?e.bind(n)(r.value,r.key,this):e(r.value,r.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){let e=this,n=this._state,i=this._head,r={[Symbol.iterator](){return r},next(){if(e._state!==n)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:i.key,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return r}values(){let e=this,n=this._state,i=this._head,r={[Symbol.iterator](){return r},next(){if(e._state!==n)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:i.value,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return r}entries(){let e=this,n=this._state,i=this._head,r={[Symbol.iterator](){return r},next(){if(e._state!==n)throw new Error("LinkedMap got modified during iteration.");if(i){let o={value:[i.key,i.value],done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return r}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let n=this._head,i=this.size;for(;n&&i>e;)this._map.delete(n.key),n=n.next,i--;this._head=n,this._size=i,n&&(n.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let n=this._tail,i=this.size;for(;n&&i>e;)this._map.delete(n.key),n=n.previous,i--;this._tail=n,this._size=i,n&&(n.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let n=e.next,i=e.previous;if(!n||!i)throw new Error("Invalid list");n.previous=i,i.next=n}e.next=void 0,e.previous=void 0,this._state++}touch(e,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==1&&n!==2)){if(n===1){if(e===this._head)return;let i=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(i.previous=r,r.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(n===2){if(e===this._tail)return;let i=e.next,r=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=r,r.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((n,i)=>{e.push([i,n])}),e}fromJSON(e){this.clear();for(let[n,i]of e)this.set(n,i)}},Me=class extends Ke{_limit;_ratio;constructor(e,n=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,n=2){return super.get(e,n)}peek(e){return super.get(e,0)}set(e,n){return super.set(e,n,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},ce=class extends Me{constructor(e,n=1){super(e,n)}trim(e){this.trimOld(e)}set(e,n){return super.set(e,n),this.checkTrim(),this}};var O=class extends Error{static SourceFileNotFound=1;static NodeNotFound=2;static NodeKindMismatch=3;code;constructor(e,n){super(e),this.code=n}},ie=class{getSymbolInfo(e,n=!1){let i=e.declarations;if(i===void 0||i.length===0)return{skip:!0};let r,o=0,a=this.getProgram();for(let l of i){let p=l.getSourceFile();r===void 0&&(r=p),(a.isSourceFileDefaultLibrary(p)||n&&a.isSourceFileFromExternalLibrary(p))&&o++}return o===i.length?{skip:!0}:{skip:!1,primary:r}}skipDeclaration(e,n=e.getSourceFile()){let i=this.getProgram();return i.isSourceFileDefaultLibrary(n)||i.isSourceFileFromExternalLibrary(n)||n.isDeclarationFile}},ue=class{referencedByContext;seenSymbols;neighborFiles;constructor(e){this.referencedByContext=void 0,this.seenSymbols=new Map,this.neighborFiles=e}getReferencedByContext(e=!1){return this.referencedByContext===void 0?this.referencedByContext=new k.ReferencedByContext(e):e&&this.referencedByContext.ensureCache(),this.referencedByContext}getSeenSymbols(e,n){let i=this.seenSymbols.get(n);return i===void 0&&(i=new _e(e),this.seenSymbols.set(n,i)),i}getPreferredNeighborFiles(e){let n=[];for(let i of this.neighborFiles){let r=e.getSourceFile(i);r!==void 0&&n.push(r)}return n}},q=class extends ie{program;symbols;constructor(e,n=new k.Symbols(e)){if(super(),e!==n.getProgram())throw new Error("Program and symbols program must match");this.program=e,this.symbols=n}getSymbols(){return this.symbols}getProgram(){return this.program}getHeritageSymbol(e){let n=this.symbols.getSymbolAtLocation(e);if(n===void 0)return;k.Symbols.isAlias(n)&&(n=this.symbols.getAliasedSymbol(n));let i=0;for(;k.Symbols.isTypeAlias(n)&&i<10;){let r=n.declarations;if(r!==void 0){let o=n;for(let a of r)if(ne.default.isTypeAliasDeclaration(a)){let l=a.type;ne.default.isTypeReferenceNode(l)&&(n=this.symbols.getLeafSymbolAtLocation(l.typeName))}if(o===n)break}i++}return n}static getNodeInProgram(e,n){let i=n.getSourceFile().fileName,r=e.getSourceFile(i);if(r===void 0)throw new O(`No source file found for ${i}`,O.SourceFileNotFound);let o=k.default.getTokenAtPosition(r,n.pos);if(o===void 0)throw new O(`No node found for ${i}:${n.pos}`,O.NodeNotFound);if(n.kind!==o.kind)throw new O(`Found node ${o.kind} for node ${n.kind} in file ${i}:${n.pos}`,O.NodeKindMismatch);return o}},Le=class{info(){}msg(){}startGroup(){}endGroup(){}},Re=class{host;codeCache;supportsCaching;symbols;constructor(e,n){this.host=e,this.codeCache=new ce(100),this.supportsCaching=n,this.symbols=new Map}reconcile(){this.symbols.clear()}getSymbols(e){let n=this.symbols.get(e);return n===void 0&&(n=new k.Symbols(e),this.symbols.set(e,n)),n}run(e,n,i){let r=this.getPossiblePrograms(e,n);for(let o of r){let l=e.with(o).run(n,i);if(l!==void 0)return[o,l]}return[void 0,void 0]}getPossiblePrograms(e,n){let i=[];for(let r of this.getLanguageServices()){let o=r.getProgram();if(o===void 0)continue;let a=e.score(o,n);a>0&&i.push([a,o])}return i.sort((r,o)=>o[0]-r[0]).map(r=>r[1])}getCachedCode(e,n){if(this.supportsCaching){if(typeof e=="string")return this.codeCache.get(e);{let i=k.Symbols.createVersionedKey(n,this,this.host);return i===void 0?void 0:this.codeCache.get(i)}}}cacheCode(e,n){if(this.supportsCaching)if(typeof e=="string")this.codeCache.set(e,n);else{let i=k.Symbols.createVersionedKey(e,this,this.host);i!==void 0&&this.codeCache.set(i,n)}}},pe=class extends Re{session;logger;constructor(e,n){super(n,!0),this.session=e;let i=k.Sessions.getProjectService(this.session);this.logger=i?.logger??new Le}logError(e,n){this.session.logError(e,n)}getFileAndProject(e){return k.Sessions.getFileAndProject(this.session,e)}getPositionInFile(e,n){return k.Sessions.getPositionInFile(this.session,e,n)}*getLanguageServices(e){let n=k.Sessions.getProjectService(this.session);if(n!==void 0)if(e===void 0){for(let i of n.configuredProjects.values())yield i.getLanguageService();for(let i of n.inferredProjects)yield i.getLanguageService();for(let i of n.externalProjects)yield i.getLanguageService()}else{let i=ne.default.server.toNormalizedPath(e.fileName),r=n.getScriptInfoForNormalizedPath(i);yield*r?r.containingProjects.map(o=>o.getLanguageService()):[]}}getScriptVersion(e){let n=ne.default.server.toNormalizedPath(e.fileName),i=k.Sessions.getProjectService(this.session);return i===void 0?void 0:i.getScriptInfoForNormalizedPath(n)?.getLatestVersion()}};var fe=class{tokenBudget;_metaItems=[];_items;constructor(e){this.tokenBudget=e,this._metaItems=[],this._items=[]}get items(){let e=this._metaItems.slice();this._items.sort((n,i)=>i.priority-n.priority);for(let n of this._items){let i=0;switch(n.kind){case"trait":i=Ee.sizeInChars(n);break;case"snippet":i=te.sizeInChars(n);break;case"relatedFile":break}if(e.push(n),this.tokenBudget.spent(i),this.tokenBudget.isExhausted())break}return e}addMetaData(e,n){this._metaItems.push(Ae.create(e,n))}addErrorData(e){this._metaItems.push(Ne.create(e.code,e.message))}addSnippet(e,n,i){if(e.isEmpty())return;let r=e.snippet(n,i);this._items.push(r)}};var _e=class{session;symbols=new Set;keys=new Set;constructor(e,n){this.session=e,this.symbols=new Set,this.keys=n?.keys??new Set}add(e){this.symbols.add(e);let n=k.Symbols.createKey(e,this.session.host);n!==void 0&&this.keys.add(n)}has(e){if(this.symbols.has(e))return!0;let n=k.Symbols.createKey(e,this.session.host);return n===void 0?!1:this.keys.has(n)?(this.symbols.add(e),!0):!1}manages(e){return this.has(e)?!0:(this.add(e),!1)}},V=class{languageService;session;symbols;cost;constructor(e,n,i){this.languageService=n,this.session=e,this.symbols=e.getSymbols(this.getProgram()),this.cost=i}getProgram(){let e=this.languageService.getProgram();if(e===void 0)throw new Error("No program available");return e}},E=class{_next;contextKind;constructor(e){this._next=void 0,this.contextKind=e}get next(){return this._next}set next(e){if(this._next!==void 0)throw new Error("Next provider already set");this._next=e}getSymbolsInScopeToQuery(){let e=this.doGetSymbolsInScopeToQuery();if(this.next!==void 0){let n=this.next.getSymbolsInScopeToQuery();n!==void 0&&(e===void 0?e=n:e=e|n)}return e}doGetSymbolsInScopeToQuery(){}getSpecificCompletionContextKind(){return this.next!==void 0?this.next.getSpecificCompletionContextKind():this.contextKind}provide(e,n,i,r){this.doProvide(e,n,i,r),this.next!==void 0&&this.next.provide(e,n,i,r)}},re=class extends Error{constructor(){super("Budget exhausted")}},me=class{charBudget;constructor(e){this.charBudget=e*4}spent(e){this.charBudget-=e}isExhausted(){return this.charBudget<=0}throwIfExhausted(){if(this.charBudget<=0)throw new re}spentAndThrowIfExhausted(e){this.spent(e),this.throwIfExhausted()}};var z=D(require("typescript")),U=D(G());var I=D(require("typescript"));var v=D(G()),Z;(r=>{function u(o,a){a??=o.getSourceFile();let l=o.getStart(a,!0),p=a.getLineAndCharacterOfPosition(l),g=a.text.substring(l,o.getEnd()).split(/\r?\n/g);if(p.character>0){let C=a.getPositionOfLineAndCharacter(p.line,0),w=a.text.substring(C,l);n(g,w)}return i(g),g}r.getLines=u;function e(o){let a=o.getFullText(),l=I.default.getLeadingCommentRanges(a,0);if(l!==void 0&&l.length>0){let p=l.at(-1).pos,d=l.at(-1).end,C=a.substring(p,d).trim().split(/\r?\n/);if(i(C),C.length>1){let x=C[1].match(/^\s+/);x!==null&&n(C,x[0])}return C}}r.getDocumentation=e;function n(o,a,l=1){let p=!0;for(let d=l;d<o.length;d++)if(!o[d].startsWith(a)){p=!1;break}if(p)for(let d=l;d<o.length;d++)o[d]=o[d].substring(a.length)}function i(o){for(;o.length>0&&o[0].trim()==="";)o.shift();for(;o.length>0&&o.at(-1).trim()==="";)o.pop()}})(Z||={});var ee=class{session;indent;lines;source;additionalSources;constructor(e,n,i=0){this.session=e,this.indent=i,this.source=n.fileName,this.lines=[],this.additionalSources=new Set}makeKey(e){if(Array.isArray(e)){let n=[];for(let i of e){let r=v.Symbols.createVersionedKey(i,this.session,this.session.host);if(r!==void 0)n.push(r);else{n=void 0;break}}return n===void 0?void 0:n.join(";")}else return v.Symbols.createVersionedKey(e,this.session,this.session.host)}getAdditionalSources(){return this.additionalSources.delete(this.source),this.additionalSources}increaseIndent(){this.indent++}decreaseIndent(){this.indent--}addPropertyDeclaration(e){this.lines.push(...Z.getLines(e))}addMethodDeclaration(e){let n=Z.getDocumentation(e);n!==void 0&&this.lines.push(...n);let i=[];i.push("	".repeat(this.indent)),e.modifiers!==void 0&&(i.push(e.modifiers.map(r=>r.getText()).join(" ")),i.push(" ")),i.push(e.name.getText()),e.typeParameters!==void 0&&(i.push("<"),i.push(e.typeParameters.map(r=>r.getText()).join(", ")),i.push(">")),i.push("("),e.parameters!==void 0&&i.push(e.parameters.map(r=>r.getText()).join(", ")),i.push(")"),e.type!==void 0&&(i.push(": "),i.push(e.type.getText())),i.push(";"),this.lines.push(i.join(""))}addFunctionDeclaration(e,n,i){n??=e.name?.getText()??"";let r=Z.getDocumentation(e);r!==void 0&&this.lines.push(...r);let o=[];o.push("	".repeat(this.indent)),o.push(this.getModifiers(e.modifiers,i)),o.push(" function "),o.push(n),o.push(this.getTypeParameters(e.typeParameters)),o.push("("),o.push(this.getParameters(e.parameters)),o.push(")"),o.push(this.getReturnTypes(e)),o.push(";"),this.lines.push(o.join(""))}getModifiers(e,n){if(e===void 0)return"";let i=[];n!==void 0&&i.push(n);for(let r of e)r.kind===I.default.SyntaxKind.AsyncKeyword||r.kind===I.default.SyntaxKind.DeclareKeyword||r.kind===I.default.SyntaxKind.ExportKeyword||i.push(r.getText());return i.join(" ")}getTypeParameters(e){if(e===void 0)return"";let n=[];return n.push("<"),n.push(e.map(i=>i.getText()).join(", ")),n.push(">"),n.join("")}getParameters(e){return e===void 0?"":e.map(n=>n.getText()).join(", ")}getReturnTypes(e){return e.type===void 0?"":`: ${e.type.getText()}`}},oe=class extends ee{type;name;constructor(e,n,i,r){super(e,n),this.type=i,this.name=r}processMembers(e){for(let[n,i]of e)this.processMember(i)}processMember(e){let n=e.declarations;if(n!==void 0){if(v.Symbols.isProperty(e)){let i=n[0];(I.default.isPropertyDeclaration(i)||I.default.isPropertySignature(i))&&this.addPropertyDeclaration(i)}else if(v.Symbols.isMethod(e))for(let i of n)(I.default.isMethodDeclaration(i)||I.default.isMethodSignature(i))&&this.addMethodDeclaration(i)}}},he=class extends oe{superClasses;includePrivates;key;constructor(e,n,i,r,o,a,l){super(e,i,r,o),this.includePrivates=l,this.key=void 0,a?(this.superClasses=new Array(...n.getAllSuperClasses(r)),this.key=this.makeKey(this.superClasses)):(this.key=this.makeKey(r),this.superClasses=void 0)}emit(){if(this.lines.push(`declare class${this.getTypeParameters()} ${this.name} {`),this.increaseIndent(),this.superClasses!==void 0)for(let e=this.superClasses.length-1;e>=0;e--){let n=this.superClasses[e];n.members!==void 0&&(v.Symbols.fillSources(this.additionalSources,n),this.processMembers(n.members))}this.type.members!==void 0&&(v.Symbols.fillSources(this.additionalSources,this.type),this.processMembers(this.type.members)),this.decreaseIndent(),this.lines.push("}")}processMember(e){!this.includePrivates&&v.Symbols.isPrivate(e)||super.processMember(e)}getTypeParameters(){let e=this.type.declarations;if(e===void 0||e.length===0)return"";let n=e[0];return I.default.isClassDeclaration(n)&&n.typeParameters!==void 0?super.getTypeParameters(n.typeParameters):""}},ye=class extends oe{superTypes;key;constructor(e,n,i,r,o){super(e,i,r,o),this.superTypes=new Array(...n.getAllSuperTypes(r)).filter(a=>v.Symbols.isInterface(a)),this.key=this.makeKey(this.superTypes)}emit(){this.lines.push(`interface ${this.name} {`),this.increaseIndent();for(let e=this.superTypes.length-1;e>=0;e--){let n=this.superTypes[e];n.members!==void 0&&(v.Symbols.fillSources(this.additionalSources,n),this.processMembers(n.members))}this.type.members!==void 0&&(v.Symbols.fillSources(this.additionalSources,this.type),this.processMembers(this.type.members)),this.decreaseIndent(),this.lines.push("}")}},Be=class extends ee{type;name;key;constructor(e,n,i,r){super(e,n),this.type=i,this.name=r,this.key=this.makeKey(i)}emit(){if(this.lines.push(`${v.Symbols.isConstEnum(this.type)?"const ":""}enum ${this.name} {`),this.increaseIndent(),this.type.exports!==void 0){let e=0,n=this.type.exports.size-1;for(let[i,r]of this.type.exports){let o=r.declarations;if(o===void 0)continue;let a=o[0];if(I.default.isEnumMember(a)){let l=Z.getLines(a);e<n&&(l[l.length-1]+=","),this.lines.push(...l)}e++}}this.decreaseIndent(),this.lines.push("}")}},qe=class extends oe{key;constructor(e,n,i,r){super(e,n,i,r)}emit(){this.lines.push(`type ${this.name} = {`),this.increaseIndent(),this.type.members!==void 0&&this.processMembers(this.type.members),this.decreaseIndent(),this.lines.push("}")}},Ve=class extends ee{func;name;constructor(e,n,i,r){super(e,n),this.func=i,this.name=r??i.getName()}get key(){}emit(e){let n=this.func.declarations;if(n!==void 0)for(let i of n){let r=i.getSourceFile().fileName;r!==e.fileName&&I.default.isFunctionDeclaration(i)&&(this.addFunctionDeclaration(i,this.name,"declare"),this.additionalSources.add(r))}}},Je=class extends ee{module;name;constructor(e,n,i,r){super(e,n),this.module=i,this.name=r??i.getName()}get key(){}emit(e){this.lines.push(`declare namespace ${this.name} {`),this.increaseIndent();let n=this.module.exports;n!==void 0&&this.addExports(n,e),this.decreaseIndent(),this.lines.push("}")}addExports(e,n){for(let[i,r]of e){let o=r.declarations;if(o!==void 0&&v.Symbols.isFunction(r))for(let a of o){let l=a.getSourceFile().fileName;l!==n.fileName&&I.default.isFunctionDeclaration(a)&&(this.addFunctionDeclaration(a,this.name,"declare"),this.additionalSources.add(l))}}}},A=class extends ie{lines;source;additionalSources;indent=0;session;symbols;currentSourceFile;seen;constructor(e,n,i,r){super(),this.lines=[],this.source=void 0,this.additionalSources=new Set,this.session=e,this.symbols=n,this.currentSourceFile=i,this.seen=r}increaseIndent(){this.indent++}decreaseIndent(){this.indent--}getProgram(){return this.symbols.getProgram()}addSource(e){this.source===void 0?this.source=e:this.additionalSources.add(e)}addAdditionalSource(e){if(e!==void 0)for(let n of e)this.additionalSources.add(n)}isEmpty(){return this.lines.length===0||this.source===void 0}snippet(e,n){if(this.source===void 0)throw new Error("No source");return this.additionalSources.delete(this.source),te.create(this.source,this.additionalSources.size===0?void 0:[...this.additionalSources],this.lines.join(`
`),e,n)}addDeclaration(e){let n=e.getSourceFile();if(n.fileName===this.currentSourceFile.fileName||this.skipDeclaration(e,n))return;let i=Z.getLines(e,n);this.indent===0?this.lines.push(...i):this.lines.push(...i.map(r=>`${"	".repeat(this.indent)}${r})`)),this.addSource(n.fileName)}addClassSymbol(e,n,i,r){if(!v.Symbols.isClass(e)||this.seen.manages(e))return;let o=this.getSymbolInfo(e);o.skip||this.addEmitter(new he(this.session,this.symbols,o.primary,e,n,i,r))}addInterfaceSymbol(e,n){if(!v.Symbols.isInterface(e)||this.seen.manages(e))return;let i=this.getSymbolInfo(e);i.skip||this.addEmitter(new ye(this.session,this.symbols,i.primary,e,n))}addTypeAliasSymbol(e,n){if(!v.Symbols.isTypeAlias(e)||this.seen.manages(e))return;let i=this.getTypeToEmit(e);if(i===void 0)return;let r=this.getSymbolInfo(i);if(r.skip)return;let o=r.primary;v.Symbols.isClass(i)?this.addEmitter(new he(this.session,this.symbols,o,i,n,!0,!1)):v.Symbols.isInterface(i)?this.addEmitter(new ye(this.session,this.symbols,o,i,n)):v.Symbols.isTypeLiteral(i)&&this.addEmitter(new qe(this.session,o,i,n))}addEnumSymbol(e,n){if(!v.Symbols.isEnum(e)||this.seen.manages(e))return;let i=this.getSymbolInfo(e);i.skip||this.addEmitter(new Be(this.session,i.primary,e,n))}addFunctionSymbol(e,n){if(!v.Symbols.isFunction(e)||this.seen.manages(e))return;let i=this.getSymbolInfo(e);i.skip||this.addEmitter(new Ve(this.session,i.primary,e,n))}addModuleSymbol(e,n){if(!v.Symbols.isValueModule(e)||this.seen.manages(e))return;let i=this.getSymbolInfo(e);i.skip||this.addEmitter(new Je(this.session,i.primary,e,n))}addEmitter(e){let n,i,r;if(e.key!==void 0){let o=this.session.getCachedCode(e.key);o!==void 0&&(n=o.value,i=o.uri,r=o.additionalUris)}(n===void 0||i===void 0)&&(e.emit(this.currentSourceFile),n=e.lines,i=e.source,r=e.getAdditionalSources(),e.key!==void 0&&this.session.cacheCode(e.key,{value:n,uri:i,additionalUris:r})),this.indent===0?this.lines.push(...n):this.lines.push(...n.map(o=>`${"	".repeat(this.indent)}${o}`)),this.addSource(i),this.addAdditionalSource(r)}getTypeToEmit(e){if(!v.Symbols.isTypeAlias(e))return;let n=e.declarations;if(n!==void 0){for(let i of n)if(I.default.isTypeAliasDeclaration(i)){let r=i.type;if(I.default.isTypeLiteralNode(r)){let o=this.symbols.getSymbolAtLocation(r);if(v.Symbols.isTypeLiteral(o))return o}else if(I.default.isTypeReferenceNode(r)){let o=this.symbols.getLeafSymbolAtLocation(r.typeName);if(v.Symbols.isInterface(o)||v.Symbols.isTypeLiteral(o)||v.Symbols.isTypeLiteral(o))return o}}}}};var je=class u extends q{classDeclaration;abstractMembers;extends;implements;constructor(e,n,i){if(super(e,n),i instanceof u){let r=i;this.classDeclaration=q.getNodeInProgram(e,r.classDeclaration),this.abstractMembers=r.abstractMembers;let o=a=>{let l=a.type,p=e.getSourceFile(l.getSourceFile().fileName);if(p!==void 0){let d=U.default.getTokenAtPosition(p,l.pos);if(z.default.isExpressionWithTypeArguments(d)){let g=n.getSymbolAtLocation(d.expression);if(g!==void 0&&!this.getSymbolInfo(g).skip)return{symbol:g,type:d,abstractMembers:a.abstractMembers}}}};if(r.extends!==void 0&&(this.extends=o(r.extends)),r.implements!==void 0){let a;for(let l of r.implements){let p=o(l);p!==void 0&&(a=a??[],a.push(p))}this.implements=a}}else{let r=i;this.classDeclaration=r;let o=r.heritageClauses;if(o===void 0){this.abstractMembers=0,this.extends=void 0,this.implements=void 0;return}let a=0,l,p;for(let d of o)if(d.token===z.default.SyntaxKind.ExtendsKeyword){if(d.types.length===1){let g=d.types[0],C=this.getHeritageSymbol(g.expression);if(C!==void 0&&!this.getSymbolInfo(C).skip){let w=this.getNumberOfAbstractMembers(C);a+=w,l={symbol:C,type:g,abstractMembers:w}}}}else if(d.token===z.default.SyntaxKind.ImplementsKeyword)for(let g of d.types){let C=this.getHeritageSymbol(g.expression);if(C!==void 0&&!this.getSymbolInfo(C).skip){p=p??[];let w=this.getNumberOfAbstractMembers(C);a+=w,p.push({symbol:C,type:g,abstractMembers:w})}}p!==void 0&&p.sort((d,g)=>g.abstractMembers-d.abstractMembers),this.abstractMembers=a,this.extends=l,this.implements=p}}with(e){return e===this.program?this:new u(e,new U.Symbols(e),this)}*all(){this.extends!==void 0&&(yield this.extends),this.implements!==void 0&&(yield*this.implements)}isSame(e){return this.classDeclaration===e||this.classDeclaration.getSourceFile().fileName===e.getSourceFile().fileName&&this.classDeclaration.pos===e.pos}score(e,n){if(this.abstractMembers===0){if(this.extends===void 0)return-1;let l=this.extends.symbol.declarations;if(l===void 0)return-1;for(let p of l)if(e.getSourceFile(p.getSourceFile().fileName)===void 0)return-1;return 1}let i;for(let l of this.all())if(l.symbol.declarations!==void 0)for(let p of l.symbol.declarations){let d=p.getSourceFile();if(e.getSourceFile(d.fileName)!==void 0){i??=0,i+=l.abstractMembers;break}}if(i===void 0)return-1;let r=i/this.abstractMembers,o=n.neighborFiles;if(o.length===0)return r;let a=Math.pow(10,o.length.toString().length);r*=a;for(let l of o)e.getSourceFile(l)!==void 0&&(r+=1);return r}run(e,n){if(this.extends===void 0&&this.implements===void 0)return;let i,r=new Map([...this.all()].map(o=>[o.symbol,o]));for(let o of this.all()){let l=o.symbol.declarations;if(l===void 0)continue;let p=new Set;for(let d of l){if(!z.default.isClassDeclaration(d)&&!z.default.isInterfaceDeclaration(d)&&!z.default.isTypeAliasDeclaration(d)||d.name===void 0)continue;let g=d.getSourceFile();if(p.has(g.fileName))continue;let C=new U.ReferencedByVisitor(this.program,g,e.getPreferredNeighborFiles(this.program),e.getReferencedByContext());for(let w of C.entries()){n.throwIfCancellationRequested();for(let x of U.ClassDeclarations.entries(w)){if(x.heritageClauses===void 0||this.isSame(x))continue;let P;for(let J of x.heritageClauses)for(let M of J.types){let H=this.getHeritageSymbol(M.expression);if(H===void 0)continue;let j=r.get(H);j!==void 0&&(P??=0,P+=j.abstractMembers)}if(P!==void 0&&(i===void 0?i={declaration:x,matchesAbstractMembers:P}:P>i.matchesAbstractMembers&&(i={declaration:x,matchesAbstractMembers:P})),i!==void 0&&i.matchesAbstractMembers===this.abstractMembers)return i}}}}}getNumberOfAbstractMembers(e){return this.symbols.getMemberStatistic(e).abstract.size}},ge=class extends V{classDeclaration;constructor(e,n,i){super(e,n,2),this.classDeclaration=i}compute(e,n,i){i.throwIfCancellationRequested();let r=this.symbols,o=r.getSymbolAtLocation(this.classDeclaration.name??this.classDeclaration);if(o===void 0||!U.Symbols.isClass(o)||o.declarations===void 0)return;let a=n.getSeenSymbols(this.session,this.getProgram()),l=this.classDeclaration.getSourceFile(),[p,d]=r.getExtendsSymbol(o);if(p!==void 0&&d!==void 0){let g=new A(this.session,r,l,a);g.addClassSymbol(p,d,!0,!1),e.addSnippet(g,"superClass",.9),a.add(p)}}},Oe=class extends V{classDeclaration;constructor(e,n,i){super(e,n,3),this.classDeclaration=i}compute(e,n,i){i.throwIfCancellationRequested();let r=this.getProgram(),o=this.classDeclaration,a=new je(r,this.symbols,o);if(a.extends===void 0&&a.implements===void 0)return;let[l,p]=this.session.run(a,n,i);if(l===void 0||p===void 0)return;let d=new A(this.session,this.session.getSymbols(l),o.getSourceFile(),n.getSeenSymbols(this.session,l));d.addDeclaration(p.declaration),e.addSnippet(d,"blueprint",1)}},Se=class u extends E{static create(e){return e.members===void 0||e.members.length===0?new He(e):new u(e)}classDeclaration;constructor(e){super("class"),this.classDeclaration=e}doProvide(e,n,i,r){r.throwIfCancellationRequested(),e.push(new ge(n,i,this.classDeclaration))}},He=class extends E{classDeclaration;constructor(e){super("wholeClass"),this.classDeclaration=e}doGetSymbolsInScopeToQuery(){return z.SymbolFlags.Function}doProvide(e,n,i,r){r.throwIfCancellationRequested(),e.push(new ge(n,i,this.classDeclaration),new Oe(n,i,this.classDeclaration))}};var Ue=require("typescript");var W=D(G()),X=class extends V{declaration;sourceFile;priority;constructor(e,n,i,r){super(e,n,1),this.declaration=i,this.sourceFile=i.getSourceFile(),this.priority=r}compute(e,n,i){let r=this.symbols,o=n.getSeenSymbols(this.session,this.getProgram());for(let l of this.declaration.parameters){i.throwIfCancellationRequested();let p=l.type;if(p===void 0)continue;let d=r.getSymbolAtTypeNodeLocation(p);d===void 0||o.has(d)||this.processSymbol(e,d,W.default.Node.getTypeName(p)??d.getName(),this.priority,o)}let a=this.declaration.type;if(a!==void 0){i.throwIfCancellationRequested();let l=r.getSymbolAtTypeNodeLocation(a);l!==void 0&&!o.has(l)&&this.processSymbol(e,l,W.default.Node.getTypeName(a)??l.getName(),this.priority,o)}}processSymbol(e,n,i,r,o){let a=this.symbols;if(W.Symbols.isClass(n)){let l=new A(this.session,a,this.sourceFile,o);l.addClassSymbol(n,i,!0,!1),e.addSnippet(l,"signature",r)}else if(W.Symbols.isInterface(n)){let l=new A(this.session,a,this.sourceFile,o);l.addInterfaceSymbol(n,i),e.addSnippet(l,"signature",r)}else if(W.Symbols.isTypeAlias(n)){let l=new A(this.session,a,this.sourceFile,o);l.addTypeAliasSymbol(n,i),e.addSnippet(l,"signature",r)}else if(W.Symbols.isEnum(n)){let l=new A(this.session,a,this.sourceFile,o);l.addEnumSymbol(n,i),e.addSnippet(l,"signature",r)}}};var Ce=class extends E{functionDeclaration;constructor(e){super("function"),this.functionDeclaration=e}doGetSymbolsInScopeToQuery(){return Ue.SymbolFlags.Function|Ue.SymbolFlags.ValueModule}doProvide(e,n,i,r){e.push(new X(n,i,this.functionDeclaration,1))}};var K=D(require("typescript")),F=D(G());var xe=class extends q{declaration;constructor(e,n,i){super(e,n),this.declaration=i}isSame(e){return this.declaration===e||this.declaration.getSourceFile().fileName===e.getSourceFile().fileName&&this.declaration.pos===e.pos}score(e,n){if(e.getSourceFile(this.declaration.getSourceFile().fileName)===void 0)return 0;let i=n.neighborFiles;if(i.length===0)return 1;let r=Math.pow(10,i.length.toString().length);for(let o of i)e.getSourceFile(o)!==void 0&&(r+=1);return r}},Te=class extends xe{constructor(e,n,i){super(e,n,i)}static create(e,n,i){let r=i.parent;if(!K.default.isClassDeclaration(r))return;let o=F.Declarations.isPrivate(i),a=[],l;if(!o){let p=n.getSymbolAtLocation(r.name!==void 0?r.name:r);if(p===void 0||!F.Symbols.isClass(p))return;let d=K.default.escapeLeadingUnderscores(i.name.getText()),g,C=!1;for(let[w,x]of n.getAllSuperTypesWithPath(p)){if(p===w&&(C=!1,g=[]),C)continue;g.push(x);let P=x.members?.get(d);if(P!==void 0){if(F.Symbols.isInterface(x)||F.Symbols.isTypeLiteral(x))a.push(...g),C=!0;else if(F.Symbols.isClass(x))if(F.Symbols.isAbstract(P))a.push(...g),C=!0;else{l=x;break}}}}if(o){let p=F.ClassDeclarations.getExtendsClause(r);if(p===void 0||p.types.length===0)return;{let d=n.getLeafSymbolAtLocation(p.types[0].expression);return d===void 0||!F.Symbols.isClass(d)?void 0:new Qe(e,n,r,d,i)}}else return l===void 0&&a.length>0&&F.Symbols.isClass(a[0])&&(l=a[0]),l!==void 0?new We(e,n,r,i,l):void 0}},ve=class u extends xe{classDeclaration;extendsSymbol;constructor(e,n,i,r,o){if(i instanceof u){let a=i,l=q.getNodeInProgram(e,a.declaration);super(e,n,l),this.classDeclaration=q.getNodeInProgram(e,a.classDeclaration);let p=a.extendsSymbol.declarations;if(p===void 0||p.length===0)throw new Error("No declarations found for extends symbol");let d;for(let g of p)if(K.default.isClassDeclaration(g)){let C=F.ClassDeclarations.getExtendsClause(g);if(C===void 0||C.types.length===0)throw new Error("No extends clause found");if(d=this.symbols.getSymbolAtLocation(C.types[0].expression),d===void 0||!F.Symbols.isClass(d))throw new Error("No extends symbol found");break}if(d===void 0)throw new Error("No extends symbol found");this.extendsSymbol=d}else super(e,n,o),this.classDeclaration=i,this.extendsSymbol=r}run(e,n){let i=this.getMemberName();for(let r of this.symbols.getDirectSubTypes(this.extendsSymbol,e.getPreferredNeighborFiles(this.program),e.getReferencedByContext(!0)))if(n.throwIfCancellationRequested(),r.members!==void 0){let o=r.members.get(i);if(o===void 0)continue;let a=o.declarations;if(a===void 0||a.length===0)continue;for(let l of a){if(l.kind!==this.declaration.kind)continue;let p=l.parent;if(!(!K.default.isClassDeclaration(p)||p===this.classDeclaration))return p}}}},Qe=class u extends ve{constructor(e,n,i,r,o){i instanceof u?super(e,n,i):super(e,n,i,r,o)}with(e){return e===this.program?this:new u(e,new F.Symbols(e),this)}getMemberName(){return K.default.escapeLeadingUnderscores(this.declaration.name.getText())}},We=class u extends Te{classDeclaration;startClass;constructor(e,n,i,r,o){if(i instanceof u){let a=i,l=q.getNodeInProgram(e,a.declaration);super(e,n,l),this.classDeclaration=q.getNodeInProgram(e,a.classDeclaration);let d=a.startClass.declarations;if(d===void 0||d.length===0)throw new Error("No declarations found for start class");let g;for(let C of d)if(K.default.isClassDeclaration(C)&&(g=this.symbols.getSymbolAtLocation(C.name?C.name:C),g!==void 0))break;if(g===void 0)throw new Error("No symbol found for start class");this.startClass=g}else super(e,n,r),this.classDeclaration=i,this.startClass=o}with(e){return e===this.program?this:new u(e,new F.Symbols(e),this)}run(e,n){let i=K.default.escapeLeadingUnderscores(this.declaration.name.getText());for(let r of this.symbols.getAllSubTypes(this.startClass,F.Traversal.breadthFirst,e.getPreferredNeighborFiles(this.program),e.getReferencedByContext(!0)))if(n.throwIfCancellationRequested(),r.members!==void 0){let o=r.members.get(i);if(o===void 0)continue;let a=o.declarations;if(a===void 0||a.length===0)continue;for(let l of a){if(!K.default.isMethodDeclaration(l))continue;let p=l.parent;if(!(!K.default.isClassDeclaration(p)||p===this.classDeclaration))return p}}}},Fe=class extends V{declaration;constructor(e,n,i){super(e,n,3),this.declaration=i}compute(e,n,i){if(i.throwIfCancellationRequested(),this.getSymbol()===void 0)return;let o=this.createSearch();if(o!==void 0){let[a,l]=this.session.run(o,n,i);if(a!==void 0&&l!==void 0){let p=this.declaration.getSourceFile(),d=new A(this.session,this.session.getSymbols(a),p,n.getSeenSymbols(this.session,a));d.addDeclaration(l),e.addSnippet(d,"blueprint",1)}}}},$e=class extends Fe{constructor(e,n,i){super(e,n,i)}createSearch(){return Te.create(this.getProgram(),this.symbols,this.declaration)}getSymbol(){let e=this.symbols.getSymbolAtLocation(this.declaration.name);return F.Symbols.isMethod(e)?e:void 0}},ke=class extends E{declaration;constructor(e){super(e.body===void 0||e.body.statements.length===0?"wholeMethod":"method"),this.declaration=e}doGetSymbolsInScopeToQuery(){return K.SymbolFlags.Function}doProvide(e,n,i,r){r.throwIfCancellationRequested(),e.push(new X(n,i,this.declaration,.9),new $e(n,i,this.declaration))}},Ye=class u extends ve{constructor(e,n,i,r,o){i instanceof u?super(e,n,i):super(e,n,i,r,o)}with(e){return e===this.program?this:new u(e,new F.Symbols(e),this)}getMemberName(){return"__constructor"}},Xe=class extends Fe{constructor(e,n,i){super(e,n,i)}createSearch(){let e=this.declaration.parent;if(!K.default.isClassDeclaration(e))return;let n=F.ClassDeclarations.getExtendsClause(e);if(!(n===void 0||n.types.length===0)){let i=this.symbols.getLeafSymbolAtLocation(n.types[0].expression);return i===void 0||!F.Symbols.isClass(i)?void 0:new Ye(this.getProgram(),this.symbols,e,i,this.declaration)}}getSymbol(){let e=this.symbols.getSymbolAtLocation(this.declaration);return F.Symbols.isConstructor(e)?e:void 0}},we=class extends E{declaration;constructor(e){super(e.body===void 0||e.body.statements.length===0?"wholeConstructor":"constructor"),this.declaration=e}doGetSymbolsInScopeToQuery(){return K.SymbolFlags.Function}doProvide(e,n,i,r){r.throwIfCancellationRequested(),e.push(new X(n,i,this.declaration,.9),new Xe(n,i,this.declaration))}};var se=class extends E{constructor(){super("none")}doProvide(e,n,i,r){}};var le=require("typescript");var ae=D(G()),Ze=class extends V{tokenAtCursor;symbolsToQuery;constructor(e,n,i,r,o=1){super(e,n,o),this.tokenAtCursor=i,this.symbolsToQuery=r}compute(e,n,i){i.throwIfCancellationRequested();let r=this.getProgram(),o=this.symbols,a=n.getSeenSymbols(this.session,r),l=this.tokenAtCursor.getSourceFile(),p=this.getModulesAndFunctionsInScope(r,o.getTypeChecker(),l);i.throwIfCancellationRequested();let d=new A(this.session,o,l,a);for(let g of p.functions.real)d.addFunctionSymbol(g);i.throwIfCancellationRequested();for(let{alias:g,real:C}of p.functions.aliased)d.addFunctionSymbol(C,g.getName());i.throwIfCancellationRequested(),d.isEmpty()||e.addSnippet(d,"generalScope",.8),d=new A(this.session,o,l,a);for(let{alias:g,real:C}of p.modules)d.addModuleSymbol(C,g.getName());i.throwIfCancellationRequested(),d.isEmpty()||e.addSnippet(d,"generalScope",.8)}getModulesAndFunctionsInScope(e,n,i){let r={functions:{real:[],aliased:[]},modules:[]},o=n.getSymbolsInScope(this.tokenAtCursor,this.symbolsToQuery|le.SymbolFlags.Alias);for(let a of o){let l=a.declarations;if(l!==void 0)for(let p of l){let d=p.getSourceFile();if(!(e.isSourceFileDefaultLibrary(d)||e.isSourceFileFromExternalLibrary(d))){if(ae.Symbols.isFunction(a)&&this.includeFunctions()&&d!==i){r.functions.real.push(a);break}else if(ae.Symbols.isAlias(a)){let g=n.getAliasedSymbol(a);if(ae.Symbols.isFunction(g)&&this.includeFunctions()){r.functions.aliased.push({alias:a,real:g});break}else if(ae.Symbols.isValueModule(g)&&this.includeValueModules()){r.modules.push({alias:a,real:g});break}}}}}return r}includeFunctions(){return(this.symbolsToQuery&le.SymbolFlags.Function)!==0}includeValueModules(){return(this.symbolsToQuery&le.SymbolFlags.ValueModule)!==0}},De=class extends E{tokenAtCursor;constructor(e){super("sourceFile"),this.tokenAtCursor=e}doProvide(e,n,i,r){r.throwIfCancellationRequested();let o=this.getSymbolsInScopeToQuery();o!==void 0&&e.push(new Ze(n,i,this.tokenAtCursor,o,2))}doGetSymbolsInScopeToQuery(){return le.SymbolFlags.Function}};var mt=new Map([[Q.default.SyntaxKind.SourceFile,(u,e)=>new De(e)],[Q.default.SyntaxKind.FunctionDeclaration,(u,e)=>new Ce(u)],[Q.default.SyntaxKind.ClassDeclaration,Se.create],[Q.default.SyntaxKind.Constructor,(u,e)=>new we(u)],[Q.default.SyntaxKind.MethodDeclaration,(u,e)=>new ke(u)]]);function ht(u,e){let n=Ie.default.getTokenAtPosition(u,e);for(;n.kind===Q.default.SyntaxKind.EndOfFileToken&&e>1;)n=Ie.default.getTokenAtPosition(u,--e);if(n.kind===Q.default.SyntaxKind.EndOfFileToken)return[new se,n];let i=[],r=n;do{let a=mt.get(r.kind);a!==void 0&&i.push(a(r,n)),r=r.parent}while(r!==void 0);if(i.length===0)return[new se,n];let o=i[i.length-1];for(let a=i.length-2;a>=0;a--)o.next=i[a],o=i[a];return[i[i.length-1],n]}function yt(u,e,n,i){let r=[];return n.provide(r,u,e,i),r.sort((o,a)=>o.cost-a.cost),r}function it(u,e,n,i,r,o,a){let l=n.getProgram();if(l===void 0)return;let p=l.getSourceFile(i);if(p===void 0)return;e.reconcile();let[d,g]=ht(p,r),C=d.getSpecificCompletionContextKind();u.addMetaData(C,Ie.default.StableSyntaxKinds.getPath(g));let w=yt(e,n,d,a),x=[];if(o!==void 0)for(let J of o)x.push(Q.default.server.toNormalizedPath(J));let P=new ue(x);for(let J of w){a.throwIfCancellationRequested();try{J.compute(u,P,a)}catch(M){if(M instanceof O)u.addErrorData(M);else throw M}}}var rt=D(require("crypto")),Pe=class{constructor(){}createHash(e){return rt.default.createHash(e)}isDebugging(){return process.execArgv.some(e=>/^--(?:inspect|debug)(?:-brk)?(?:=\d+)?$/i.test(e))}};function gt(u){let e=!1,n,i,r,o=p=>{if(p.arguments===void 0)return{response:{error:"noArguments",message:"No arguments provided"},responseRequired:!0};let d=p.arguments,g=n?.getFileAndProject(d);if(g===void 0)return{response:{error:"noProject",message:"No project founds"},responseRequired:!0};if(typeof d.line!="number"||typeof d.offset!="number")return{response:{error:"invalidArguments",message:"No project founds"},responseRequired:!0};let{file:C,project:w}=g,x=n?.getPositionInFile(d,C);if(x===void 0)return{response:{error:"invalidPosition",message:"Position not valid"},responseRequired:!0};let P=typeof d.timeBudget=="number"?d.timeBudget:75,J=new ot.CancellationTokenWithTimer(i?.getCancellationToken?i.getCancellationToken():void 0,P,n?.host.isDebugging()??!1),M=new me(typeof d.tokenBudget=="number"?d.tokenBudget:7*1024),H=new fe(M);try{it(H,n,w.getLanguageService(),C,x,d.neighborFiles,J)}catch(j){if(!(j instanceof de.OperationCanceledException)&&!(j instanceof re))return j instanceof Error?{response:{error:"exception",message:j.message,stack:j.stack},responseRequired:!0}:{response:{error:"exception",message:"Unknown error"},responseRequired:!0}}return{response:{items:H.items,timedOut:J.isTimedOut(),tokenBudgetExhausted:M.isExhausted()},responseRequired:!0}};function a(p){if(e)return p.languageService;if(p.session!==void 0&&n===void 0)try{let d=l();r={kind:"ok",session:!0,supported:d,version:de.default.version},p.session.addProtocolHandler("_.copilot.ping",()=>({response:r,responseRequired:!0})),d&&(n=new pe(p.session,new Pe),i=p.languageServiceHost,p.session.addProtocolHandler("_.copilot.context",o))}catch(d){d instanceof Error?(r={kind:"error",message:d.message,stack:d.stack},p.session.logError(d,"_.copilot.installHandler")):(r={kind:"error",message:"Unknown error"},p.session.logError(new Error("Unknown error"),"_.copilot.installHandler"))}finally{e=!0}return p.languageService}function l(){try{let p=de.default.versionMajorMinor.split(".");if(p.length<2)return!1;let d=parseInt(p[0]),g=parseInt(p[1]);return d>5||d===5&&g>=5}catch{return!1}}return{create:a}}module.exports=gt;
